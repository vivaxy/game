/* catapult at 1.0.0 by vivaxy on 20141209 */
!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var Cart=function(a,b){this.x=a,this.y=b,this.ctx=document.getElementsByClassName("canvas")[0].getContext("2d")};Cart.prototype.draw=function(){this.ctx.fillStyle="blue",this.ctx.fillRect(this.x-200,this.y,200,50)};var Wheel=function(){this.ctx=document.getElementsByClassName("canvas")[0].getContext("2d"),this.radius=40};Wheel.prototype.draw=function(){};var Spoon=function(a,b){this.ctx=document.getElementsByClassName("canvas")[0].getContext("2d"),this.x=a,this.y=b,this.minDegree=20,this.degree=20,this.maxDegree=70,this.stage=0};Spoon.prototype.draw=function(){this.ctx.strokeStyle="blue",this.ctx.lineWidth=10,this.ctx.translate(this.x,this.y),this.ctx.rotate((90-this.degree)*Math.PI/180),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(-200,0),this.ctx.arc(-250,0,50,0,Math.PI),this.ctx.stroke(),this.ctx.rotate(-(90-this.degree)*Math.PI/180),this.ctx.translate(-this.x,-this.y)};var Catapult=function(){this.x=300,this.y=500,this.cart=new Cart(this.x,this.y),this.spoon=new Spoon(this.x,this.y),this.wheel=new Wheel,this.cart.draw(),this.spoon.draw()},Ball=function(a,b){this.x=a,this.y=b,this.ctx=document.getElementsByClassName("canvas")[0].getContext("2d"),this.radius=40};Ball.prototype.draw=function(a){a=(90-a)*Math.PI/180;var b=250,c=this.x-b*Math.cos(a),d=this.y-b*Math.sin(a);this.ctx.fillStyle="orange",this.ctx.beginPath(),this.ctx.arc(c,d,this.radius,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill()};var Input=function(){this.events={},document.addEventListener("keydown",this.keyDown.bind(this),!1),document.addEventListener("keyup",this.keyUp.bind(this),!1),document.addEventListener("touchstart",this.keyDown.bind(this),!1),document.addEventListener("touchend",this.keyUp.bind(this),!1)};Input.prototype.bindEvent=function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)},Input.prototype.emitEvent=function(a,b){var c=this.events[a];c&&c.forEach(function(a){a(b)})},Input.prototype.clearEvent=function(a){this.events[a]=null},Input.prototype.keyDown=function(){this.emitEvent("key-down")},Input.prototype.keyUp=function(){this.emitEvent("key-up")};var Game=function(){this.canvas=document.getElementsByClassName("canvas")[0],this.ctx=this.canvas.getContext("2d"),this.hint=document.getElementsByClassName("hint")[0],this.canvas.width=400,this.canvas.height=600,this.ctx.fillStyle="rgb(200,200,200)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.looper=0,this.catapult=new Catapult,this.ball=new Ball(300,500),this.ball.draw(this.catapult.spoon.degree),this.input=new Input,this.input.bindEvent("key-down",this.keyDown.bind(this),!1),this.input.bindEvent("key-up",this.keyUp.bind(this),!1)};Game.prototype.keyDown=function(){switch(this.catapult.spoon.stage){case 0:this.catapult.spoon.stage=1,this.pull()}},Game.prototype.keyUp=function(){switch(this.catapult.spoon.stage){case 1:this.loose(),this.catapult.spoon.stage=2}},Game.prototype.pull=function(){this.catapult.spoon.degree+=.1,this.ctx.fillStyle="rgb(200,200,200)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.catapult.cart.draw(),this.catapult.spoon.draw(),this.ball.draw(this.catapult.spoon.degree),this.catapult.spoon.degree>=this.catapult.spoon.maxDegree?(this.hint.innerHTML="fail",this.catapult.spoon.stage=3,cancelAnimationFrame(this.looper)):this.looper=requestAnimationFrame(this.pull.bind(this))},Game.prototype.loose=function(){this.catapult.spoon.degree-=10,this.ctx.fillStyle="rgb(200,200,200)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.catapult.cart.draw(),this.catapult.spoon.draw(),this.catapult.spoon.degree<=this.catapult.spoon.minDegree?cancelAnimationFrame(this.looper):this.looper=requestAnimationFrame(this.loose.bind(this))};var game=new Game;
//# sourceMappingURL=catapult.min.map