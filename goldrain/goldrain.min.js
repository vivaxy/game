/* goldrain at 1.0.0 by vivaxy on 20141209 */
!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var Coin=function(a){this.canvas=a,this.ctx=this.canvas.getContext("2d"),this.score=1,this.speed=2,this.radius=20,this.x=this.randomX(),this.y=-this.radius};Coin.prototype.randomX=function(){return this.radius+Math.random()*(this.canvas.width-2*this.radius)},Coin.prototype.fall=function(){this.y=this.y+this.speed},Coin.prototype.draw=function(){this.ctx.fillStyle="red",this.ctx.beginPath(),this.ctx.arc(this.x,this.y,this.radius,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill()},Coin.prototype.inBowl=function(a){return this.y<this.canvas.height&&this.y>this.canvas.height-a.height&&a.x-a.width/2<this.x&&a.x+a.width/2>this.x};var Bowl=function(a){this.canvas=a,this.ctx=this.canvas.getContext("2d"),this.width=100,this.height=50,this.x=this.canvas.width/2,this.direction=0,this.speed=1,this.hasCoins=0};Bowl.prototype.move=function(){return this.x<=this.width/2&&-1===this.direction||this.x>=this.canvas.width-this.width/2&&1===this.direction?void(this.direction=0):void(this.x=this.x+this.direction*this.speed)},Bowl.prototype.draw=function(){this.ctx.fillStyle="blue",this.ctx.fillRect(this.x-this.width/2,this.canvas.height-this.height,this.width,this.height)},Bowl.prototype.changeDirection=function(a){this.direction=a};var Input=function(){this.events={},this.keyMap={37:-1,39:1,65:-1,68:1},document.addEventListener("keydown",this.keyDown.bind(this),!1),document.addEventListener("touchstart",this.touchStart.bind(this),!1),document.addEventListener("touchmove",this.touchMove.bind(this),!1),document.addEventListener("touchend",this.touchEnd.bind(this),!1)};Input.prototype.bindEvent=function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)},Input.prototype.emitEvent=function(a,b){var c=this.events[a];c&&c.forEach(function(a){a(b)})},Input.prototype.clearEvent=function(a){this.events[a]=null},Input.prototype.keyDown=function(a){var b=this.keyMap[a.which];void 0!==b&&(a.preventDefault(),this.emitEvent("change-direction",b))},Input.prototype.touchStart=function(a){a.preventDefault(),a.touches.length>1||(this.touchStartX=a.touches[0].clientX,this.touchStartY=a.touches[0].clientY)},Input.prototype.touchMove=function(a){a.preventDefault()},Input.prototype.touchEnd=function(a){if(a.preventDefault(),!(a.touches.length>0)){var b=a.changedTouches[0].clientX-this.touchStartX;if(Math.abs(b)>10){var c=0>b?-1:1;this.emitEvent("change-direction",c)}}};var Game=function(){this.canvas=document.getElementsByTagName("canvas")[0],this.canvas.width=400,this.canvas.height=600,this.ctx=this.canvas.getContext("2d"),this.looper=0,this.nextCoinAt=(new Date).getTime(),this.nextCoinInterval=1e3,this.coins=[],this.bowl=new Bowl(this.canvas),this.input=new Input,this.input.bindEvent("change-direction",this.bowl.changeDirection.bind(this.bowl)),this.loop()};Game.prototype.loop=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),(new Date).getTime()>this.nextCoinAt&&(this.coins.push(new Coin(this.canvas)),this.nextCoinAt+=this.nextCoinInterval);for(var a=0;a<this.coins.length;a++){var b=this.coins[a];b.fall(),b.draw(),b.y>this.canvas.height-this.bowl.height&&b.inBowl(this.bowl)&&(this.coins.splice(a,1),this.bowl.hasCoins+=b.score)}this.bowl.move(),this.bowl.draw(),this.looper=requestAnimationFrame(this.loop.bind(this))},new Game;
//# sourceMappingURL=goldrain.min.map